## 01前言
	- 在 B 端产品中，会经常遇到数据批量导入的场景，使用批量导入，可以快速将客户的电子表格数据导入到我们的平台上，从而提高工作人员的效率，所以对以数据为主的B端管理平台，做好批量导入交互设计至关重要。
- ## 02思考点
	- 在满足需求的同时，要基于易用性、友好型等多方面考虑用户的交互体验，并兼顾性能方面影响，所以要注意以下思考点：
		- （1）批量导入的入口
		- （2）导入事项说明提醒
		- （3）导入进度通知
		- （4）导入结果通知，成功/失败提醒及后续交互
		- （6）大批量导入性能及交互
- ## 03解决方案
	- **（1）批量导入的入口**
	  collapsed:: true
		- **位置：**批量导入适用于数据量较大的表格，通常把操作放在表外部上方，这样操作更便捷，同时便于分开批处理和单个操作。
			- 补充知识
			  collapsed:: true
				- 批处理操作模式允许用户对一行或多行对象执行操作，通常与复选框操作配合使用，并在选中复选框后激活表上方操作按钮，如删除、批准、拒绝、复制之类的操作，这将节省用户时间，避免重复对多行进行相同操作。
				- 通常也分显、隐性两种操作。其中，显性操作较为常用，外漏操作简单易懂。隐性操作容易造成记忆负担，增加学习成本，适合批量操作较低频的操作，没有那么复杂的产品。**批量导入在本公司的业务中属于高频操作，故选择显性操作方式；**
		- **交互：**该按钮为需一直启用的次要按钮，所以可以设计为高亮并且颜色上与主按钮区分即可；（如果像批量启用/禁用/删除这类按钮，需要默认是禁用状态，选择数据后才会高亮启用）
		- ![image.png](../assets/image_1700042420745_0.png)
	- **（2）导入事项说明提醒**
	  collapsed:: true
		- 需要梳理一下提示方式和提示内容：
		- **①文件类型**
		- 系统数据承载文件类型。用什么文件合适，从业务和数据需求出发，桨毂性能压力，综合考虑：
			- -Word 文件：
			  collapsed:: true
				- 文字内容和格式排版：Word 文件适合存储和分享文字内容，如报告、文档、合同等。它提供了丰富的排版和格式化功能，适用于需要保留文本样式和布局的场景。
			- -Excel 文件：
			  collapsed:: true
				- 数据表格和计算：Excel 文件适合存储和管理结构化数据，如表格、清单、数据集等。它提供了强大的计算和数据分析功能，适用于需要进行数据计算、排序、筛选和图表展示的场景。
			- -Txt 文件：
			  collapsed:: true
				- Txt 文件适合存储纯粹的文本数据，没有格式和排版。它通常用于存储简单的文本信息、日志记录、配置文件等。Txt 文件非常灵活，可以在各种系统和应用程序之间进行简单的数据交换。
		- **②文件格式**
			- 系统需要的数据格式。梳理分析数据字段，明确各个字段注意事项。最优的解决方案是提供上传模板的文件，支持快速下载，让用户直接在模板里操作并直观查看必要的说明。
		- **③特殊逻辑**
			- 文件类型和文件格式均合法后，需思考异常情况，例如：
				- 导入数据出现同名如何处理，是覆盖还是导入失败？（结合失败提醒设计）
		- **④其他考虑**
			- 思考其他情况说明，例如：考虑导入大批量数据时的性能上限，综合程序的性能和等待时长的考虑提示单次支持最大批导行数的建议。
		- ![image.png](../assets/image_1700042387566_0.png)
	- **（3）导入进度通知**
		- 批量导入是一个黑盒的操作过程，让用户能够直观的掌握导入进度，而不是盲目等待可以极大提高用户体验。此处，可采用显示导入进度条的形式来展示目前进度。
		- ![image.png](../assets/image_1700042519308_0.png)
	- **（4）导入结果通知，成功/失败**
		- 导入完成的状态分为两种，成功或者失败；
		- -成功：可以直接弹窗提示成功。
		- -失败：失败的情况大致可分为四种
			- **1）文件类型不对**
				- 在用户上传时做文件类型检测；
					- 例如：系统要求上传.xls或者.xlsx文件，用户传了.sql文件可以直接提示拦截在上传这步。
				- 此类情况如何友好的进行提醒:
					- 如果类型错误，直接拦截并toast提示用户文件类型不正确，让用户重新上传符合类型的文件。
			- **2）数据格式不对**
				- 此类错误在用户上传文件时并不好校验，那么可以在点击导入后先对数据格式（字符限制、置空等）进行校验，首先校验文件格式是否符合系统的字段需求：
					- 例如：系统需要用户上传的文件字段是姓名和邮箱，用户上传了一个文件字段是家庭住址和身份证号码的，跟系统模板完全不一致，系统可以在这步直接提示用户，让他根据导入模板调整格式后再上传。
				- 此类情况如何友好的进行提醒:
					- 若不符合则直接弹窗提示用户导入文件表格格式不符。
			- **3）字段不正确**
				- 系统在导入数据时增加字段数据校验，字段数据有误，那么系统需进行错误提醒。
					- 例如：手机号码是11位的数字，用户名是小于30个字符的文本，上传的文件里某个人的手机号码写了20位字符
				- 此类情况如何友好的进行提醒:
					- ①基础设计：可以在导入完成后有个提示，提示导入成功多少条数据，导入失败多少条数据，然后失败的数据可以下载失败数据文件，以具体查看失败原因，用户可以根据每条的提示进行针对性的修改。
					- ②进阶设计：针对错误数量，
			- **4）超出单次上传要求最大量限制**
				- 在导入文件的超出限制的数据时，需要进行报错提醒：
				- 此类情况如何友好的进行提醒:
					- 弹窗提示导入失败多少条数据，然后失败的数据可以下载，失败数据每条后面标记上失败原因是因为超出单次导入最大限制。
			-
	- **（5）大批量导入**
		- 需要考虑用户如果导入大批量数据时的性能上限问题，所以可以考虑以下几个方案：
		- ①提示说明：
			- 可以综合性能和等待时长，在导入注意事项说明中给出一个单次支持最大导出行数的建议及等待时间，避免系统错误使用户陷入无止境的等待而不自知。
		- ②异步导入：
			- 当导入的数据量大而且涉及很多关联数据的时候，可能系统会需要后台花较长的时间处理。此时，可以考虑使用异步导入的方式。
				- 异步导入意味着用户上传表格后无法马上获得导入的反馈，此时需要提供一个导入记录给用户查看批量导入的结果。其交互设计可参考：文件基础校验成功后，收起上传进度条提示窗至系统某处（醒目的导入记录入口），同时通过角标告诉可以采用角标的方式标注当前正在进行中的导入操作，下面是一个交互引导的示例原型。
				- ![B端产品如何优雅地实现数据批量导入](https://image.woshipm.com/wp-files/2023/01/uTm39Nda0eiUBKSlxq0X.gif)
- ## 05 实用避坑建议
	- 实际批量导入会涉及很多细节，这些细节如果不注意可能会产生很多坑，这里总结网上前辈踩过的一些坑。
		- **Excel单元格格式：**Excel 本身会对一些特殊的数据进行处理，典型的就是日期格式会转换为微软自带的日期格式（实际是一串数字）。因此建议单元格格式统一使用文本格式，这种在不同的平台都能够保持一致。
		- **金额：**显示时，Excel会默认对超过2位小数的数值进行四舍五入。因此，在单元格为文本格式的前提下，建议对数值加上小数位校验。
		- **保存导入的记录和源文件：**对于一些敏感的财务类数据，很可能过了很久客户才会发现问题，这个时候他们会对系统的准确性产生质疑。通过保存导入的记录和源文件，可以帮助我们对比是客户提供的数据的问题还是系统的问题（通常都是数据的问题）。可能这个过程中，反而让客户提升了对系统的信任感。
		- **校验过程处理：**通常表格导入涉及两部分校验，一是数据格式的校验，二是数据合法性的校验。数据合法性是指系统内关联的数据的校验，比如员工所在部门存不存在、手机号是否重复等等。这种需要查询数据库进行校验，可能会很慢。因此，对于这种情况，考虑降低服务器侧的压力，可以采取数据格式校验不通过后直接返回错误信息，没必要再进行后续的合法性校验。
		- **出错导入处理：**出错后有两种方式，一种是将正确的数据导入进去，一种是只要出错整个表格都不导入。这两种做法都有道理，取决于具体的应用场景。例如：对于财务类毕竟敏感的数据，处理方式是只要出错都不导入，这是因为财务比较严谨，需要核对最后导入的金额。如果部分导入，意味着导入的时间点上存在偏差，不便于核对。但对于其他情况，可以部分导入，给用户提供一份只有错误行的表格和一份错误对照表，用户修改完错误数据后，再将这部分数据导入即可。